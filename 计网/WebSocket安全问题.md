> WebSocket引入web**并不会解决既有的安全问题**,这就要求开发者了解这些安全问题,并预防

#### 认证

WebSocket并**没有规定要如何进行认证**

服务器可以采用任何 HTTP 服务器的客户端身份认证机制,如cookie/http/tls

*WebSocket所面临的安全问题也是现在web所面临的问题*

#### 授权

WebSocket**没有指定任何授权方式**,所有需要开发者自己实现

安全问题:*垂直权限提升和水平权限提升*

#### 跨域请求

WebSocket使用基于*源*的安全模型,在WebSocket握手时请求将会携带*origin*的头

Oringin字段表示发起请求的源，以此来防止未经授权的跨站点访问请求

因为WebSocket的客户端**不仅仅是浏览器**,所有在指定WebSocket的时候*并没有强制规定使用origin*

这样一来如果开发者没有针对*origin*头的验证,那么将会导致*跨站点WebSocket劫持攻击(CSWSH)*

> 解决方案
>
> **浏览器对origin对进行检测**,但是这也不是百分百安全的方法,因为网页可以伪造Origin头信息，绕过服务端对Origin头的检查
>
> *更加完善的方法是借鉴CSRF的解决方案-令牌机制*

#### 拒绝服务

WebSocket是**面向连接的协议**,所以可以被引起客户端/服务器拒绝服务攻击

##### 客户端拒绝服务

WebSocket和http连接限制不同,WebSocket**受到更高的限制**,firefox中WebSocke最大连接数为200,**只要用尽允许的所有Websocket连接**耗尽浏览器资源，**引起拒绝服务**

##### 服务端拒绝服务

方式一:WebSocket建立的持久连接,那么攻击者就可以发送大量的连接耗尽资源

预防措施,限制单ip最大连接数

方式二:不开大量连接,就一个连接**发送大量数据**(2^16) 或 发送一个**长流的分片消息的小帧**

预防措施:限制帧大小与重组帧大小验证(即将长流中的分片组合后验证大小)

#### 中间人攻击

http -> ws  https-wss

建议建立wss,因为是建立在https加密信道上

#### 输入校验

对来自客户端的输入进行验证

防范来客户端的XSS攻击，服务端的SQL注入，代码注入等攻击